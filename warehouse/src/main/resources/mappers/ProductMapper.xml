<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.msb.mapper.ProductMapper">

  <select id="selectAllProductPage" parameterType="com.msb.pojo.Product" resultType="com.msb.pojo.Product">
    select t1.*, t2.store_name, t3.brand_name, t4.type_name,
    t5.supply_name, t6.place_name, t7.unit_name from
    product t1, store t2, brand t3, product_type t4, supply t5,
    place t6, unit t7
    where t1.store_id = t2.store_id and t1.brand_id = t3.brand_id
    and t1.type_id = t4.type_id and t1.supply_id = t5.supply_id
    and t1.place_id = t6.place_id and t1.unit_id = t7.unit_id
    <if test="product.storeId != null">
      and t1.store_id = #{product.storeId}
    </if>
    <if test="product.productName != null and product.productName != ''">
      and t1.product_name like concat('%',#{product.productName},'%')
    </if>
    <if test="product.brandName != null and product.brandName != ''">
      and t3.brand_name like concat('%', #{product.brandName}, '%')
    </if>
    <if test="product.typeName != null and product.typeName != ''">
      and t4.type_name like concat('%', #{product.typeName}, '%')
    </if>
    <if test="product.supplyName != null and product.supplyName != ''">
      and t5.supply_name like concat('%', #{product.supplyName}, '%')
    </if>
    <if test="product.placeName != null and product.placeName != ''">
      and t6.place_name like concat('%', #{product.placeName}, '%')
    </if>
    <if test="product.upDownState != null and product.upDownState != ''">
      and t1.up_down_state = #{product.upDownState}
    </if>
    <if test="product.isOverDate != null and product.isOverDate != '' and product.isOverDate==1">
      and date_format(now(), '%y-%m-%d') &gt; t1.supp_date
    </if>
    <if test="product.isOverDate != null and product.isOverDate != '' and product.isOverDate==0">
      and date_format(now(), '%y-%m-%d') &lt; t1.supp_date
    </if>
    order by t1.create_time
  </select>


  <!--查询所有的前台需要导出的数据表格的数据-->
  <select id="queryAllProductTableData" parameterType="com.msb.pojo.Product" resultType="Product">
    select t1.*, t2.store_name, t3.brand_name, t4.type_name,
    t5.supply_name, t6.place_name, t7.unit_name from
    product t1, store t2, brand t3, product_type t4, supply t5,
    place t6, unit t7
    where t1.store_id = t2.store_id and t1.brand_id = t3.brand_id
    and t1.type_id = t4.type_id and t1.supply_id = t5.supply_id
    and t1.place_id = t6.place_id and t1.unit_id = t7.unit_id
    <if test="product.storeId != null">
      and t1.store_id = #{product.storeId}
    </if>
    <if test="product.productName != null and product.productName != ''">
      and t1.product_name like concat('%',#{product.productName},'%')
    </if>
    <if test="product.brandName != null and product.brandName != ''">
      and t3.brand_name like concat('%', #{product.brandName}, '%')
    </if>
    <if test="product.typeName != null and product.typeName != ''">
      and t4.type_name like concat('%', #{product.typeName}, '%')
    </if>
    <if test="product.supplyName != null and product.supplyName != ''">
      and t5.supply_name like concat('%', #{product.supplyName}, '%')
    </if>
    <if test="product.placeName != null and product.placeName != ''">
      and t6.place_name like concat('%', #{product.placeName}, '%')
    </if>
    <if test="product.upDownState != null and product.upDownState != ''">
      and t1.up_down_state = #{product.upDownState}
    </if>
    <if test="product.isOverDate != null and product.isOverDate != '' and product.isOverDate==1">
      and date_format(now(), '%y-%m-%d') &gt; t1.supp_date
    </if>
    <if test="product.isOverDate != null and product.isOverDate != '' and product.isOverDate==0">
      and date_format(now(), '%y-%m-%d') &lt; t1.supp_date
    </if>
    order by t1.create_time
  </select>
</mapper>